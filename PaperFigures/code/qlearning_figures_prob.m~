%% Plotting the performance
addpath('/Users/minhnhatle/Dropbox (MIT)/Sur/MatchingSimulations/PaperFigures/code')

prob = 0;

rootdir = '/Users/minhnhatle/Dropbox (MIT)/Sur/MatchingSimulations/simdata/';
savedir = '/Users/minhnhatle/Dropbox (MIT)/Sur/MatchingSimulations/PaperFigures/qlearningFigs';
savedir = sprintf('%s/prob%.2f', savedir, prob);
if ~exist(savedir, 'dir')
    mkdir(savedir);
end


filedir = sprintf('%sEGreedyQLearningAgent-withCorr-prob%.2fto%.2f-072321.mat', rootdir, prob, 1-prob);
load(filedir);


produce_heatmap(efflist, epslst, gammalst, 'clim', [0.5,1], 'legendname', 'Efficiency', ...
    'x_label', '$\epsilon$', 'y_label', '$\gamma$', 'vertline', 0.24, 'horline', 1.22);
saveas(gcf, sprintf('%s/%sprob%.2f.pdf', savedir, 'qlearning-eff', prob))


%% Plotting the switch offset
produce_heatmap(-PLoffsetlist, epslst, gammalst, 'clim', [0 10], 'legendname', 'Offset', ...
    'x_label', '$\epsilon$','y_label', '$\gamma$', 'vertline', 0.24, 'horline', 1.22);
saveas(gcf, sprintf('%s/%sprob%.2f.pdf', savedir, 'qlearning-offset', prob))


%% Plotting the switch slope
produce_heatmap(PLslopelist, epslst, gammalst, 'clim', [0, 5], 'legendname', 'Slope', ...
    'x_label', '$\epsilon$', 'y_label', '$\gamma$', 'vertline', 0.24, 'horline', 1.22);
saveas(gcf, sprintf('%s/%sprob%.2f.pdf', savedir, 'qlearning-slope', prob))


%% Plotting the lapse rate (exploration)
produce_heatmap(LapseR, epslst, gammalst, 'clim', [0, 0.5], 'legendname', 'Lapse', ...
    'x_label', '$\epsilon$', 'y_label', '$\gamma$', 'vertline', 0.24, 'horline', 1.22);
saveas(gcf, sprintf('%s/%sprob%.2f.pdf', savedir, 'qlearning-lapse', prob))


%% Correlations
% produce_heatmap(ParamsA, epslst, gammalst, 'clim', [0,3], 'legendname', 'CorrA', ...
%     'x_label', '$\epsilon$', 'y_label', '$\gamma$');
% produce_heatmap(ParamsB, epslst, gammalst, 'clim', [0,10], 'legendname', 'CorrB', ...
%     'x_label', '$\epsilon$', 'y_label', '$\gamma$');

slope_at_X4 = ParamsA .* ParamsB .* exp(-ParamsA * 4);
produce_heatmap(slope_at_X4, epslst, gammalst, 'clim', [0,3], 'legendname', 'CorrB', ...
    'x_label', '$\epsilon$', 'y_label', '$\gamma$', 'vertline', 0.24, 'horline', 1.22);
saveas(gcf, sprintf('%s/%sprob%.2f.pdf', savedir, 'qlearning-CorrSlopeX4', prob))


%% Theoretical eff
% theoryeff = 0.5 + (1 - LapseL) .* (0.5 + PLoffsetlist / 30);
% produce_heatmap(theoryeff, epslst, gammalst, 'clim', [0.5 1], 'Theory eff');


%% Plot correlation fits
pAarr = ParamsA(:,12);
pBarr = ParamsB(:,12);
xarr = 1:20;
colors = linspace(0.3, 1, 5);

figure;
lines = [];
labels = {};
for id = 1:5
%     subplot(2,4,id)
    i = 1 + (id - 1) * 4;
    A = pAarr(i);
    B = pBarr(i);
    yarr = B - B*exp(-A*xarr);
    lines(id) = plot(xarr, yarr, 'Color', [0 0 colors(id)]);
    labels{id} = sprintf('%.2f', gammalst(i));
    hold on
    ylim([0, 10])
%     title(sprintf('gamma = %.2f', gammalst(i)));
end

mymakeaxis('x_label', 'Number of rewards', 'y_label', 'Number of errors');
c = legend(lines, labels);
c.Title.String = '\gamma';







